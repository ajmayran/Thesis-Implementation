{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Pass Prediction - Social Work Licensure</title>
    
    <link rel="stylesheet" href="{% static 'admin_dashboard/css/sidebar.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/css/base.css' %}">
    <link rel="stylesheet" href="{% static 'prediction/css/predict.css' %}">
    <link rel="stylesheet" href="{% static 'fontawesome/css/all.min.css'%}">
</head>

<body>
    
    <div class="flex min-h-screen">
        
        {% include 'components/sidebar.html' %}

        <div class="flex-1 main-content">
            
            <!-- Page Header -->
            <header class="page-header">
                <div>
                    <h1>Exam Pass Prediction</h1>
                    <p>Social Work Licensure Examination</p>
                </div>
                <a href="{% url 'dashboard:home' %}" class="back-btn">
                    <i class="fa-solid fa-arrow-left"></i>Back to Dashboard
                </a>
            </header>

            <!-- Main Content -->
            <main>
                
                <!-- Alert Messages -->
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }}">
                            <i class="fa-solid {% if message.tags == 'error' %}fa-circle-exclamation{% elif message.tags == 'warning' %}fa-triangle-exclamation{% else %}fa-circle-info{% endif %}"></i>
                            <span>{{ message }}</span>
                        </div>
                    {% endfor %}
                {% endif %}

                <!-- Info Box -->
                <div class="info-box">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="fa-solid fa-circle-info info-icon"></i>
                        </div>
                        <div class="ml-4">
                            <h3>About This Prediction Tool</h3>
                            <p>
                                This AI-powered tool analyzes your academic background, study habits, and preparation level 
                                to predict your likelihood of passing the Social Work Licensure Examination. 
                                Fill out all fields accurately for the most reliable prediction.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Prediction Form -->
                <form method="POST" id="predictionForm">
                    {% csrf_token %}

                    <!-- Personal Information Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fa-solid fa-user"></i>
                            </div>
                            <div class="section-info">
                                <h2>Personal Information</h2>
                                <p>Basic demographic information</p>
                            </div>
                        </div>

                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label class="form-label" for="id_age">{{ form.age.label }}</label>
                                {{ form.age }}
                                {% if form.age.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.age.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.age.help_text %}
                                    <p class="help-text">{{ form.age.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_gender">{{ form.gender.label }}</label>
                                {{ form.gender }}
                                {% if form.gender.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.gender.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Academic Background Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fa-solid fa-graduation-cap"></i>
                            </div>
                            <div class="section-info">
                                <h2>Academic Background</h2>
                                <p>Your academic performance indicators</p>
                            </div>
                        </div>

                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label class="form-label" for="id_gpa">{{ form.gpa.label }}</label>
                                {{ form.gpa }}
                                {% if form.gpa.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.gpa.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.gpa.help_text %}
                                    <p class="help-text">{{ form.gpa.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_internship_grade">{{ form.internship_grade.label }}</label>
                                {{ form.internship_grade }}
                                {% if form.internship_grade.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.internship_grade.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.internship_grade.help_text %}
                                    <p class="help-text">{{ form.internship_grade.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_scholarship">{{ form.scholarship.label }}</label>
                                {{ form.scholarship }}
                                {% if form.scholarship.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.scholarship.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.scholarship.help_text %}
                                    <p class="help-text">{{ form.scholarship.help_text }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Study Habits & Preparation Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fa-solid fa-book"></i>
                            </div>
                            <div class="section-info">
                                <h2>Study Habits & Preparation</h2>
                                <p>Your current preparation routine</p>
                            </div>
                        </div>

                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label class="form-label" for="id_study_hours">{{ form.study_hours.label }}</label>
                                {{ form.study_hours }}
                                {% if form.study_hours.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.study_hours.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.study_hours.help_text %}
                                    <p class="help-text">{{ form.study_hours.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_sleep_hours">{{ form.sleep_hours.label }}</label>
                                {{ form.sleep_hours }}
                                {% if form.sleep_hours.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.sleep_hours.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.sleep_hours.help_text %}
                                    <p class="help-text">{{ form.sleep_hours.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_review_center">{{ form.review_center.label }}</label>
                                {{ form.review_center }}
                                {% if form.review_center.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.review_center.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.review_center.help_text %}
                                    <p class="help-text">{{ form.review_center.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_confidence">{{ form.confidence.label }}</label>
                                {{ form.confidence }}
                                {% if form.confidence.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.confidence.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.confidence.help_text %}
                                    <p class="help-text">{{ form.confidence.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_test_anxiety">{{ form.test_anxiety.label }}</label>
                                {{ form.test_anxiety }}
                                {% if form.test_anxiety.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.test_anxiety.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.test_anxiety.help_text %}
                                    <p class="help-text">{{ form.test_anxiety.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_mock_exam_score">{{ form.mock_exam_score.label }}</label>
                                {{ form.mock_exam_score }}
                                {% if form.mock_exam_score.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.mock_exam_score.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.mock_exam_score.help_text %}
                                    <p class="help-text">{{ form.mock_exam_score.help_text }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Personal Factors Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fa-solid fa-lightbulb"></i>
                            </div>
                            <div class="section-info">
                                <h2>Personal Factors</h2>
                                <p>Skills and support system assessment</p>
                            </div>
                        </div>

                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label class="form-label" for="id_english_proficiency">{{ form.english_proficiency.label }}</label>
                                {{ form.english_proficiency }}
                                {% if form.english_proficiency.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.english_proficiency.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.english_proficiency.help_text %}
                                    <p class="help-text">{{ form.english_proficiency.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_motivation_score">{{ form.motivation_score.label }}</label>
                                {{ form.motivation_score }}
                                {% if form.motivation_score.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.motivation_score.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.motivation_score.help_text %}
                                    <p class="help-text">{{ form.motivation_score.help_text }}</p>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_social_support">{{ form.social_support.label }}</label>
                                {{ form.social_support }}
                                {% if form.social_support.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.social_support.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.social_support.help_text %}
                                    <p class="help-text">{{ form.social_support.help_text }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Socioeconomic Background Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fa-solid fa-briefcase"></i>
                            </div>
                            <div class="section-info">
                                <h2>Socioeconomic Background</h2>
                                <p>Family and employment information</p>
                            </div>
                        </div>

                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label class="form-label" for="id_income_level">{{ form.income_level.label }}</label>
                                {{ form.income_level }}
                                {% if form.income_level.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.income_level.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="id_employment_status">{{ form.employment_status.label }}</label>
                                {{ form.employment_status }}
                                {% if form.employment_status.errors %}
                                    <ul class="errorlist">
                                        {% for error in form.employment_status.errors %}<li>{{ error }}</li>{% endfor %}
                                    </ul>
                                {% endif %}
                                {% if form.employment_status.help_text %}
                                    <p class="help-text">{{ form.employment_status.help_text }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Non-field Errors -->
                    {% if form.non_field_errors %}
                        <div class="alert alert-error mb-6">
                            <i class="fa-solid fa-circle-exclamation"></i>
                            <div>
                                {% for error in form.non_field_errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}

                    <!-- Submit Button -->
                    <div class="submit-section">
                        <button type="submit" class="btn-predict" id="submitBtn">
                            <i class="fa-solid fa-wand-magic-sparkles"></i>
                            Generate Prediction
                        </button>
                        <p class="security-note">
                            <i class="fa-solid fa-shield-halved security-icon"></i>
                            Your data is processed securely and not stored permanently
                        </p>
                    </div>

                </form>

            </main>

        </div>
    </div>

    <script>
        // Form submission handler
        document.getElementById('predictionForm').addEventListener('submit', function(e) {
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Processing...';
        });

        // Validate study hours and sleep hours total
        const studyHours = document.getElementById('id_study_hours');
        const sleepHours = document.getElementById('id_sleep_hours');

        function validateTotalHours() {
            const study = parseInt(studyHours.value) || 0;
            const sleep = parseInt(sleepHours.value) || 0;
            
            if (study + sleep > 24) {
                studyHours.style.borderColor = '#dc2626';
                sleepHours.style.borderColor = '#dc2626';
                return false;
            } else {
                studyHours.style.borderColor = '#e5e7eb';
                sleepHours.style.borderColor = '#e5e7eb';
                return true;
            }
        }

        studyHours.addEventListener('input', validateTotalHours);
        sleepHours.addEventListener('input', validateTotalHours);
    </script>

</body>
</html>